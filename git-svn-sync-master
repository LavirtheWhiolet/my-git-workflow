#!/bin/bash

if [ "$1" = "-h" -o "$1" = "--help" ]; then
  cat <<HELP

Usage: git-svn-sync-master [-h|--help]

Synchronizes master branch with SVN trunk.

If "-h" or "--help" is specified then this program prints this message and
exits.

HELP
  exit
fi

current_branch=`git symbolic-ref --short HEAD`
{ [ "$current_branch" = "master" ] || git checkout master; } && \
git pull --rebase && \
git svn rebase && \
git svn dcommit && \
git push && \
{ [ "$current_branch" = "master" ] || git checkout "$current_branch"; }
